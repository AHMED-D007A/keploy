(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2769:(e,t,a)=>{Promise.resolve().then(a.bind(a,9774))},9774:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eX});var r=a(5155),s=a(2115),l=a(2596),n=a(9688);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,l.$)(t))}var i=a(9708),c=a(2085);let d=(0,c.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function u(e){let{className:t,variant:a,size:s,asChild:l=!1,...n}=e,c=l?i.DX:"button";return(0,r.jsx)(c,{"data-slot":"button",className:o(d({variant:a,size:s,className:t})),...n})}let p=s.createContext(null);function h(){let e=s.useContext(p);if(!e)throw Error("useSidebar must be used within a SidebarProvider");return e}function m(e){let{children:t}=e,[a,l]=s.useState(!0);return(0,r.jsx)(p.Provider,{value:{isOpen:a,toggle:()=>l(!a)},children:(0,r.jsx)("div",{className:"flex h-screen",children:t})})}function g(e){let{children:t,className:a}=e,{isOpen:s}=h();return(0,r.jsx)("div",{className:o("bg-gray-50 border-r transition-all duration-300",s?"w-64":"w-16",a),children:t})}function x(e){let{children:t,className:a}=e;return(0,r.jsx)("div",{className:o("p-4 border-b",a),children:t})}function f(e){let{children:t,className:a}=e;return(0,r.jsx)("div",{className:o("flex-1 overflow-y-auto p-4",a),children:t})}function v(e){let{className:t}=e,{toggle:a}=h();return(0,r.jsx)(u,{onClick:a,variant:"ghost",size:"sm",className:o("p-1 cursor-pointer",t),children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}function b(e){let{children:t,className:a}=e;return(0,r.jsx)("main",{className:o("flex-1 overflow-auto",a),children:t})}var j=a(5604);let y=j.Ik({step_name:j.Yj(),step_count:j.ai().int().nonnegative(),step_failure:j.ai().int().nonnegative(),step_response_time:j.YO(j.ai().nonnegative()),step_bytes_in:j.ai().int().nonnegative(),step_bytes_out:j.ai().int().nonnegative()}),_=j.Ik({vu_id:j.ai().int().min(0),ts_exec_count:j.ai().int().nonnegative(),ts_exec_failure:j.ai().int().nonnegative(),ts_exec_time:j.YO(j.ai().nonnegative()),steps:j.YO(y)}),N=j.Ik({Target:j.ai().int().positive(),Duration:j.Yj()}),w=j.Ik({Metric:j.Yj(),Condition:j.Yj(),Severity:j.Yj(),Value:j.ai()}),S=j.Ik({Profile:j.Yj(),VUs:j.ai().int().positive(),Duration:j.Yj(),RPS:j.ai().int().positive(),Stages:j.YO(N).optional(),Thresholds:j.YO(w).optional()}),k=j.Ik({id:j.Yj().min(1),url:j.Yj().url(),title:j.Yj().min(1),created_at:j.Yj(),description:j.Yj(),load_options:S,end_at:j.Yj().optional()}),C=j.Ik({timestamp:j.ai().int().positive(),value:j.ai().nonnegative()}),A=j.Ik({timestamp:j.ai().int().positive(),avg_latency:j.ai().nonnegative()}),V=j.Ik({overall:j.YO(A),perStep:j.g1(j.Yj(),j.YO(C)),perVU:j.g1(j.Yj(),j.YO(C))});j.YO(k);let z=j.YO(_);j.Ik({dashboardData:j.g1(j.Yj(),z),chartHistories:j.g1(j.Yj(),V),dashboardStopTimes:j.g1(j.Yj(),j.Yj())});var I=a(3904),E=a(574),M=a(4416);function U(e){let{selectedDashboard:t,onSelectDashboard:a,onDashboardDeleted:l}=e,{isOpen:n}=h(),[o,i]=(0,s.useState)([]),[c,d]=(0,s.useState)(!1),[p,m]=(0,s.useState)(null),v=async()=>{d(!0),m(null);try{for(let e=0;e<3;e++){let t=await fetch("http://localhost:2345/dashboards");if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();i(e=>{let t=[a,...e];return localStorage.setItem("klt-dashboards",JSON.stringify(t)),t}),e<2&&await new Promise(e=>setTimeout(e,300))}}catch(e){console.error("Failed to fetch dashboards:",e)}finally{d(!1)}};return(0,s.useEffect)(()=>{let e=localStorage.getItem("klt-dashboards");if(e)try{let t=JSON.parse(e);i(t)}catch(e){console.error("Failed to parse saved dashboards:",e)}v()},[]),(0,r.jsxs)(g,{children:[(0,r.jsx)(x,{children:(0,r.jsx)("div",{className:"flex items-center gap-2 w-full",children:(0,r.jsxs)(u,{onClick:v,disabled:c,variant:"ghost",size:"sm",className:"p-2 rounded-md hover:bg-gray-100 w-full justify-start cursor-pointer",children:[(0,r.jsx)(I.A,{className:"h-4 w-4 ".concat(c?"animate-spin":"")}),n&&(0,r.jsx)("h2",{className:"font-semibold text-lg ml-2",children:"KLT Dashboards"})]})})}),(0,r.jsx)(f,{children:(0,r.jsxs)("div",{className:"space-y-2",children:[p&&n&&(0,r.jsx)("div",{className:"text-xs text-red-500 mt-1",children:p}),c&&(0,r.jsx)("div",{className:"text-sm text-gray-400 ".concat(!n&&"sr-only"),children:"Loading..."}),!c&&0===o.length&&!p&&(0,r.jsx)("div",{className:"text-sm text-gray-500 ".concat(!n&&"sr-only"),children:"No dashboards found"}),o.map(e=>(0,r.jsxs)("div",{className:"\n                w-full flex items-center gap-2 p-2 rounded-md transition-colors group\n                ".concat((null==t?void 0:t.id)===e.id?"bg-blue-100 text-blue-900":"hover:bg-gray-100","\n              "),children:[(0,r.jsxs)("button",{onClick:()=>a(e),className:"flex items-center gap-2 flex-1 min-w-0 text-left",children:[(0,r.jsx)(E.A,{className:"h-4 w-4 flex-shrink-0"}),n&&(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("div",{className:"text-sm font-medium truncate",children:e.title}),(0,r.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.id})]})]}),n&&(0,r.jsx)(u,{onClick:t=>{t.stopPropagation();var a=e.id;i(e=>{let t=e.filter(e=>e.id!==a);return localStorage.setItem("klt-dashboards",JSON.stringify(t)),t});try{let e=localStorage.getItem("dashboard-storage");if(e){let t=JSON.parse(e);t.dashboardData&&t.dashboardData[a]&&delete t.dashboardData[a],t.chartHistories&&t.chartHistories[a]&&delete t.chartHistories[a],t.dashboardStopTimes&&t.dashboardStopTimes[a]&&delete t.dashboardStopTimes[a],localStorage.setItem("dashboard-storage",JSON.stringify(t)),console.log("Cleaned up data for dashboard: ".concat(a))}}catch(e){console.error("Failed to clean up dashboard data:",e)}null==l||l(a)},variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100 h-6 w-6 p-0 hover:bg-red-100 hover:text-red-600 transition-opacity",title:"Delete ".concat(e.title),children:(0,r.jsx)(M.A,{className:"h-3 w-3"})})]},e.id))]})})]})}let P=(0,s.createContext)(void 0);function O(e){let{children:t}=e,[a,l]=(0,s.useState)(null);return(0,r.jsx)(P.Provider,{value:{selectedDashboard:a,setSelectedDashboard:l},children:t})}function D(e){let{lttoken:t,currentVUCount:a=0,stopped:l=!1,stopTime:n}=e,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],[a,r]=(0,s.useState)("0s");return(0,s.useEffect)(()=>{if(!e||t)return;let a=()=>{let t=new Date(e).getTime(),a=Math.max(0,Math.floor((Date.now()-t)/1e3)),s=Math.floor(a/3600),l=Math.floor(a%3600/60),n=a%60;s>0?r("".concat(s,"h ").concat(l,"m ").concat(n,"s")):l>0?r("".concat(l,"m ").concat(n,"s")):r("".concat(n,"s"))};a();let s=setInterval(a,1e3);return()=>clearInterval(s)},[e,t]),a}(null==t?void 0:t.created_at,l);if(!t)return(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:(0,r.jsx)(R,{children:(0,r.jsxs)(Y,{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Select a dashboard"})]})})});let i=[{label:"Profile",value:t.load_options.Profile,color:"text-gray-600"},{label:"Active VUs",value:"".concat(a," / ").concat(t.load_options.VUs),color:"text-gray-600"},{label:"Target Duration",value:t.load_options.Duration,color:"text-gray-600"},{label:l?"Final Runtime":"Elapsed Time",value:l?n||"Stopped":o,color:l?"text-red-600":"text-blue-600"},{label:"Target RPS",value:t.load_options.RPS.toLocaleString(),color:"text-gray-600"},{label:"Status",value:l?"Completed":"Running",color:l?"text-red-600":"text-green-600"}];return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"bg-white rounded-lg border p-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:t.title}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:t.description}),(0,r.jsxs)("p",{className:"text-gray-500 text-xs mt-2",children:["ID: ",t.id]})]}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(l?"bg-red-100 text-red-800":"bg-green-100 text-green-800"),children:l?"Completed":"Running"})]})}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:i.map(e=>(0,r.jsx)(R,{children:(0,r.jsxs)(Y,{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold ".concat(e.color),children:e.value}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.label})]})},e.label))})]})}function R(e){let{children:t,className:a=""}=e;return(0,r.jsx)("div",{className:"bg-white rounded-lg border shadow-sm ".concat(a),children:t})}function Y(e){let{children:t,className:a=""}=e;return(0,r.jsx)("div",{className:"p-4 ".concat(a),children:t})}var F=a(6268),T=a(1032);function K(e){let{data:t,columns:a,enableRowSelection:r=!0,defaultPageIndex:l,defaultPageSize:n,getRowId:o}=e,[i,c]=s.useState({}),[d,u]=s.useState({}),[p,h]=s.useState([]),[m,g]=s.useState([]),[x,f]=s.useState({pageIndex:null!=l?l:0,pageSize:null!=n?n:10});return(0,F.N4)({data:t,columns:a,state:{sorting:m,columnVisibility:d,rowSelection:i,columnFilters:p,pagination:x},enableRowSelection:r,getRowId:null!=o?o:e=>e.id.toString(),onRowSelectionChange:c,onSortingChange:g,onColumnFiltersChange:h,onColumnVisibilityChange:u,onPaginationChange:f,getCoreRowModel:(0,T.HT)(),getFilteredRowModel:(0,T.hM)(),getPaginationRowModel:(0,T.kW)(),getSortedRowModel:(0,T.h5)(),getFacetedRowModel:(0,T.kQ)(),getFacetedUniqueValues:(0,T.oS)()})}var L=a(17);function H(e){let{className:t,...a}=e;return(0,r.jsx)(L.bL,{"data-slot":"tabs",className:o("flex flex-col gap-2",t),...a})}function G(e){let{className:t,...a}=e;return(0,r.jsx)(L.B8,{"data-slot":"tabs-list",className:o("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...a})}function B(e){let{className:t,...a}=e;return(0,r.jsx)(L.l9,{"data-slot":"tabs-trigger",className:o("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a})}var J=a(5143),W=a(1206),q=a(402);function Q(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",{"data-slot":"table",className:o("w-full caption-bottom text-sm",t),...a})})}function X(e){let{className:t,...a}=e;return(0,r.jsx)("thead",{"data-slot":"table-header",className:o("[&_tr]:border-b",t),...a})}function Z(e){let{className:t,...a}=e;return(0,r.jsx)("tbody",{"data-slot":"table-body",className:o("[&_tr:last-child]:border-0",t),...a})}function $(e){let{className:t,...a}=e;return(0,r.jsx)("tr",{"data-slot":"table-row",className:o("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function ee(e){let{className:t,...a}=e;return(0,r.jsx)("th",{"data-slot":"table-head",className:o("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function et(e){let{className:t,...a}=e;return(0,r.jsx)("td",{"data-slot":"table-cell",className:o("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}var ea=a(8266);function er(e){let{row:t}=e,{transform:a,transition:s,setNodeRef:l,isDragging:n}=(0,q.gl)({id:t.original.id});return(0,r.jsx)($,{"data-state":t.getIsSelected()&&"selected","data-dragging":n,ref:l,className:"relative z-0 data-[dragging=true]:z-10 data-[dragging=true]:opacity-80",style:{transform:ea.Ks.Transform.toString(a),transition:s},children:t.getVisibleCells().map(e=>(0,r.jsx)(et,{children:(0,F.Kv)(e.column.columnDef.cell,e.getContext())},e.id))})}function es(e){let{table:t,columns:a,dndEnabled:l=!1,onReorder:n}=e,o=t.getRowModel().rows.map(e=>Number(e.id)),i=s.useId(),c=(0,J.FR)((0,J.MS)(J.cA,{}),(0,J.MS)(J.IG,{}),(0,J.MS)(J.uN,{})),d=(0,r.jsxs)(Q,{children:[(0,r.jsx)(X,{className:"bg-muted sticky top-0 z-10",children:t.getHeaderGroups().map(e=>(0,r.jsx)($,{children:e.headers.map(e=>(0,r.jsx)(ee,{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,F.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,r.jsx)(Z,{className:"**:data-[slot=table-cell]:first:w-8",children:function(e){let{table:t,columns:a,dndEnabled:s,dataIds:l}=e;return t.getRowModel().rows.length?s?(0,r.jsx)(q.gB,{items:l,strategy:q._G,children:t.getRowModel().rows.map(e=>(0,r.jsx)(er,{row:e},e.id))}):t.getRowModel().rows.map(e=>(0,r.jsx)($,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,r.jsx)(et,{children:(0,F.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,r.jsx)($,{children:(0,r.jsx)(et,{colSpan:a.length,className:"h-24 text-center",children:"No results."})})}({table:t,columns:a,dndEnabled:l,dataIds:o})})]});return l?(0,r.jsx)(J.Mp,{collisionDetection:J.fp,modifiers:[W.FN],onDragEnd:function(e){let{active:a,over:r}=e;if(a&&r&&a.id!==r.id&&n){let e=o.indexOf(a.id),s=o.indexOf(r.id);n((0,q.be)(t.options.data,e,s))}},sensors:c,id:i,children:d}):d}var el=a(2278),en=a(2355),eo=a(3052),ei=a(2767),ec=a(968);function ed(e){let{className:t,...a}=e;return(0,r.jsx)(ec.b,{"data-slot":"label",className:o("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}var eu=a(1918),ep=a(6474),eh=a(5196),em=a(7863);function eg(e){let{...t}=e;return(0,r.jsx)(eu.bL,{"data-slot":"select",...t})}function ex(e){let{...t}=e;return(0,r.jsx)(eu.WT,{"data-slot":"select-value",...t})}function ef(e){let{className:t,size:a="default",children:s,...l}=e;return(0,r.jsxs)(eu.l9,{"data-slot":"select-trigger","data-size":a,className:o("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l,children:[s,(0,r.jsx)(eu.In,{asChild:!0,children:(0,r.jsx)(ep.A,{className:"size-4 opacity-50"})})]})}function ev(e){let{className:t,children:a,position:s="popper",...l}=e;return(0,r.jsx)(eu.ZL,{children:(0,r.jsxs)(eu.UC,{"data-slot":"select-content",className:o("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...l,children:[(0,r.jsx)(ej,{}),(0,r.jsx)(eu.LM,{className:o("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,r.jsx)(ey,{})]})})}function eb(e){let{className:t,children:a,...s}=e;return(0,r.jsxs)(eu.q7,{"data-slot":"select-item",className:o("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[(0,r.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,r.jsx)(eu.VF,{children:(0,r.jsx)(eh.A,{className:"size-4"})})}),(0,r.jsx)(eu.p4,{children:a})]})}function ej(e){let{className:t,...a}=e;return(0,r.jsx)(eu.PP,{"data-slot":"select-scroll-up-button",className:o("flex cursor-default items-center justify-center py-1",t),...a,children:(0,r.jsx)(em.A,{className:"size-4"})})}function ey(e){let{className:t,...a}=e;return(0,r.jsx)(eu.wn,{"data-slot":"select-scroll-down-button",className:o("flex cursor-default items-center justify-center py-1",t),...a,children:(0,r.jsx)(ep.A,{className:"size-4"})})}function e_(e){let{table:t}=e;return(0,r.jsx)("div",{className:"flex items-center justify-between px-4",children:(0,r.jsxs)("div",{className:"flex w-full items-center gap-8 lg:w-fit",children:[(0,r.jsxs)("div",{className:"hidden items-center gap-2 lg:flex",children:[(0,r.jsx)(ed,{htmlFor:"rows-per-page",className:"text-sm font-medium",children:"Rows per page"}),(0,r.jsxs)(eg,{value:"".concat(t.getState().pagination.pageSize),onValueChange:e=>t.setPageSize(Number(e)),children:[(0,r.jsx)(ef,{className:"h-8 w-[70px] bg-white border border-gray-300 hover:bg-gray-50",id:"rows-per-page",children:(0,r.jsx)(ex,{placeholder:t.getState().pagination.pageSize})}),(0,r.jsx)(ev,{side:"top",className:"bg-white border border-gray-300 shadow-lg",children:[10,20,30,40,50].map(e=>(0,r.jsx)(eb,{value:"".concat(e),className:"hover:bg-gray-100",children:e},e))})]})]}),(0,r.jsxs)("div",{className:"flex w-fit items-center justify-center text-sm font-medium",children:["Page ",t.getState().pagination.pageIndex+1," of ",t.getPageCount()]}),(0,r.jsxs)("div",{className:"ml-auto flex items-center gap-2 lg:ml-0",children:[(0,r.jsxs)(u,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>t.setPageIndex(0),disabled:!t.getCanPreviousPage(),children:[(0,r.jsx)("span",{className:"sr-only",children:"Go to first page"}),(0,r.jsx)(el.A,{})]}),(0,r.jsxs)(u,{variant:"outline",className:"size-8",size:"icon",onClick:()=>t.previousPage(),disabled:!t.getCanPreviousPage(),children:[(0,r.jsx)("span",{className:"sr-only",children:"Go to previous page"}),(0,r.jsx)(en.A,{})]}),(0,r.jsxs)(u,{variant:"outline",className:"size-8",size:"icon",onClick:()=>t.nextPage(),disabled:!t.getCanNextPage(),children:[(0,r.jsx)("span",{className:"sr-only",children:"Go to next page"}),(0,r.jsx)(eo.A,{})]}),(0,r.jsxs)(u,{variant:"outline",className:"hidden size-8 lg:flex",size:"icon",onClick:()=>t.setPageIndex(t.getPageCount()-1),disabled:!t.getCanNextPage(),children:[(0,r.jsx)("span",{className:"sr-only",children:"Go to last page"}),(0,r.jsx)(ei.A,{})]})]})]})})}function eN(e){return"number"!=typeof e||isNaN(e)?"-":(e/1048576).toFixed(2)}function ew(e){let{data:t}=e,[a,l]=s.useState(()=>null!=t?t:[]),[n,o]=s.useState("virtual-users"),[i,c]=s.useState(()=>null!=t?t:[]),[d,u]=s.useState(()=>(null!=t?t:[]).flatMap(e=>Array.isArray(e.steps)?e.steps.map(t=>({...t,vu_id:e.vu_id})):[]));s.useEffect(()=>{l(null!=t?t:[]),c(null!=t?t:[]),u((null!=t?t:[]).flatMap(e=>Array.isArray(e.steps)?e.steps.map(t=>({...t,vu_id:e.vu_id})):[]))},[t]),s.useEffect(()=>{"virtual-users"===n?c(a):"steps"===n&&u(a.flatMap(e=>Array.isArray(e.steps)?e.steps.map(t=>({...t,vu_id:e.vu_id})):[]))},[n,a]);let p=s.useMemo(()=>{let e={},t={};return a.forEach(a=>{Array.isArray(a.steps)&&a.steps.forEach(a=>{let r=a.step_name;if(r&&(e[r]||(e[r]={step_name:r,step_count:0,step_failure:0,step_response_time:[],step_bytes_in:0,step_bytes_out:0,step_response_time_averages:[]},t[r]=[]),e[r].step_count+="number"==typeof a.step_count?a.step_count:0,e[r].step_failure+="number"==typeof a.step_failure?a.step_failure:0,e[r].step_bytes_in+="number"==typeof a.step_bytes_in?a.step_bytes_in:0,e[r].step_bytes_out+="number"==typeof a.step_bytes_out?a.step_bytes_out:0,Array.isArray(a.step_response_time)&&a.step_response_time.length>0)){e[r].step_response_time.push(...a.step_response_time);let s=a.step_response_time.reduce((e,t)=>e+t,0)/a.step_response_time.length;t[r].push(s)}})}),Object.keys(e).forEach(a=>{e[a].step_response_time_averages=t[a]}),Object.values(e)},[a]);s.useEffect(()=>{"steps"===n&&u(p)},[n,p]);let h=[{accessorKey:"vu_id",header:"VU ID"},{accessorKey:"ts_exec_count",header:"TS Exec Count"},{accessorKey:"ts_exec_failure",header:"TS Exec Failure"},{accessorKey:"ts_exec_time",header:"Avg TS Exec Time (ms)",cell:e=>{let{row:t}=e;var a=t.original.ts_exec_time;return Array.isArray(a)&&0!==a.length?(a.reduce((e,t)=>e+t,0)/a.length/1e6).toFixed(2):"-"}},{accessorKey:"steps",header:"Step Exec Count",cell:e=>{let{row:t}=e;return Array.isArray(t.original.steps)?t.original.steps.reduce((e,t)=>e+("number"==typeof t.step_count?t.step_count:0),0):"-"}}],m=[{accessorKey:"step_name",header:"Step Name"},{accessorKey:"step_count",header:"Step Count (All VUs)",cell:e=>{var t;let{row:a}=e;return null!=(t=a.original.step_count)?t:"-"}},{accessorKey:"step_failure",header:"Step Failure (All VUs)",cell:e=>{var t;let{row:a}=e;return null!=(t=a.original.step_failure)?t:"-"}},{accessorKey:"step_bytes_in",header:"Bytes In (MB)",cell:e=>{let{row:t}=e;return eN(t.original.step_bytes_in)}},{accessorKey:"step_bytes_out",header:"Bytes Out (MB)",cell:e=>{let{row:t}=e;return eN(t.original.step_bytes_out)}},{accessorKey:"step_response_time",header:"Avg Step Response Time (ms)",cell:e=>{let{row:t}=e,a=t.original.step_response_time_averages;return Array.isArray(a)&&0!==a.length?(a.reduce((e,t)=>e+t,0)/a.length/1e6).toFixed(2):"-"}},{accessorKey:"p95",header:"P95 (ms)",cell:e=>{let{row:t}=e;var a=t.original.step_response_time;if(!Array.isArray(a)||0===a.length)return"-";let r=[...a].sort((e,t)=>e-t),s=Math.floor(.95*(r.length-1));return(r[s]/1e6).toFixed(2)}}],g=K({data:i,columns:h,getRowId:(e,t)=>null!=e.vu_id?e.vu_id.toString():"row-".concat(t)}),x=K({data:d,columns:m,getRowId:(e,t)=>null!=e.vu_id&&null!=e.step_name?"".concat(e.vu_id,"-").concat(e.step_name):e.step_name?e.step_name+"-"+t:"row-"+t});return t&&0!==t.length?(0,r.jsxs)("div",{className:"w-full bg-white rounded-lg border overflow-hidden",children:[(0,r.jsx)("div",{className:"p-4 border-b bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Load Test Data"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"virtual-users"===n?"".concat(i.length," Virtual Users"):"".concat(p.length," Unique Steps")})]}),(0,r.jsx)(H,{value:n,onValueChange:e=>o(e),className:"w-fit",children:(0,r.jsxs)(G,{children:[(0,r.jsx)(B,{value:"virtual-users",children:"Virtual Users"}),(0,r.jsx)(B,{value:"steps",children:"Steps"})]})})]})}),(0,r.jsxs)("div",{className:"relative flex flex-col",children:[(0,r.jsx)("div",{className:"overflow-hidden px-2",children:"virtual-users"===n?(0,r.jsx)(es,{dndEnabled:!0,table:g,columns:h,onReorder:c}):(0,r.jsx)(es,{dndEnabled:!0,table:x,columns:m,onReorder:u})}),(0,r.jsx)("div",{className:"p-4 border-t bg-gray-50",children:"virtual-users"===n?(0,r.jsx)(e_,{table:g}):(0,r.jsx)(e_,{table:x})})]})]}):(0,r.jsx)("div",{className:"w-full bg-white rounded-lg border p-8 text-center text-gray-500",children:"No VU data available"})}var eS=a(8247),ek=a(3406),eC=a(7156);function eA(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:o("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function eV(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:o("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function ez(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:o("leading-none font-semibold",t),...a})}function eI(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:o("text-muted-foreground text-sm",t),...a})}function eE(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:o("px-6",t),...a})}var eM=a(3540),eU=a(8124),eP=a(2319);let eO={light:"",dark:".dark"},eD=s.createContext(null);function eR(e){let{id:t,className:a,children:l,config:n,...i}=e,c=s.useId(),d="chart-".concat(t||c.replace(/:/g,""));return(0,r.jsx)(eD.Provider,{value:{config:n},children:(0,r.jsxs)("div",{"data-slot":"chart","data-chart":d,className:o("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",a),...i,children:[(0,r.jsx)(eY,{id:d,config:n}),(0,r.jsx)(eM.u,{children:l})]})})}let eY=e=>{let{id:t,config:a}=e,s=Object.entries(a).filter(e=>{let[,t]=e;return t.theme||t.color});return s.length?(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(eO).map(e=>{let[a,r]=e;return"\n".concat(r," [data-chart=").concat(t,"] {\n").concat(s.map(e=>{var t;let[r,s]=e,l=(null==(t=s.theme)?void 0:t[a])||s.color;return l?"  --color-".concat(r,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},eF=eU.m;function eT(e){let{active:t,payload:a,className:l,indicator:n="dot",hideLabel:i=!1,hideIndicator:c=!1,label:d,labelFormatter:u,labelClassName:p,formatter:h,color:m,nameKey:g,labelKey:x}=e,{config:f}=function(){let e=s.useContext(eD);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),v=s.useMemo(()=>{var e;if(i||!(null==a?void 0:a.length))return null;let[t]=a,s="".concat(x||(null==t?void 0:t.dataKey)||(null==t?void 0:t.name)||"value"),l=eK(f,t,s),n=x||"string"!=typeof d?null==l?void 0:l.label:(null==(e=f[d])?void 0:e.label)||d;return u?(0,r.jsx)("div",{className:o("font-medium",p),children:u(n,a)}):n?(0,r.jsx)("div",{className:o("font-medium",p),children:n}):null},[d,u,a,i,p,f,x]);if(!t||!(null==a?void 0:a.length))return null;let b=1===a.length&&"dot"!==n;return(0,r.jsxs)("div",{className:o("border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",l),children:[b?null:v,(0,r.jsx)("div",{className:"grid gap-1.5",children:a.map((e,t)=>{let a="".concat(g||e.name||e.dataKey||"value"),s=eK(f,e,a),l=m||(null==s?void 0:s.color)||e.color||e.stroke||e.fill||"hsl(var(--chart-".concat(t%5+1,"))");return(0,r.jsx)("div",{className:o("[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5","dot"===n&&"items-center"),children:h&&(null==e?void 0:e.value)!==void 0&&e.name?h(e.value,e.name,e,t,e.payload):(0,r.jsxs)(r.Fragment,{children:[(null==s?void 0:s.icon)?(0,r.jsx)(s.icon,{}):!c&&(0,r.jsx)("div",{className:o("shrink-0 rounded-[2px]",{"h-2.5 w-2.5":"dot"===n,"w-1":"line"===n,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===n,"my-0.5":b&&"dashed"===n}),style:{backgroundColor:"dashed"!==n?l:"transparent",borderColor:l,..."dashed"===n&&{borderStyle:"dashed"}}}),(0,r.jsxs)("div",{className:o("flex flex-1 justify-between leading-none",b?"items-end":"items-center"),children:[(0,r.jsxs)("div",{className:"grid gap-1.5",children:[b?v:null,(0,r.jsx)("span",{className:"text-muted-foreground",children:(null==s?void 0:s.label)||e.name})]}),e.value&&(0,r.jsx)("span",{className:"text-foreground font-mono font-medium tabular-nums",children:"number"==typeof e.value?e.value.toLocaleString():e.value})]})]})},e.dataKey||t)})})]})}function eK(e,t,a){if("object"!=typeof t||null===t)return;let r="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,s=a;return a in t&&"string"==typeof t[a]?s=t[a]:r&&a in r&&"string"==typeof r[a]&&(s=r[a]),s in e?e[s]:e[a]}eP.s;var eL=a(2493);let eH=(0,c.F)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}}),eG=s.createContext({size:"default",variant:"default"});function eB(e){let{className:t,variant:a,size:s,children:l,...n}=e;return(0,r.jsx)(eL.bL,{"data-slot":"toggle-group","data-variant":a,"data-size":s,className:o("group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs",t),...n,children:(0,r.jsx)(eG.Provider,{value:{variant:a,size:s},children:l})})}function eJ(e){let{className:t,children:a,variant:l,size:n,...i}=e,c=s.useContext(eG);return(0,r.jsx)(eL.q7,{"data-slot":"toggle-group-item","data-variant":c.variant||l,"data-size":c.size||n,className:o(eH({variant:c.variant||l,size:c.size||n}),"min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l",t),...i,children:a})}function eW(e){return Array.isArray(e)&&0!==e.length?e.reduce((e,t)=>e+t,0)/e.length:0}function eq(e){let{vuData:t=[],chartHistory:a,setChartHistory:l}=e,[n,o]=s.useState("overall"),[i,c]=s.useState(!1),d=s.useRef("");s.useEffect(()=>{if(!Array.isArray(t)||0===t.length)return;let e=JSON.stringify(t.map(e=>{var t;return{id:e.vu_id,stepCount:(null==(t=e.steps)?void 0:t.length)||0,timestamp:Date.now()}}));if(e===d.current)return;d.current=e;let a=Date.now(),r=[];t.forEach(e=>{var t;null==(t=e.steps)||t.forEach(e=>{Array.isArray(e.step_response_time)&&r.push(...e.step_response_time)})});let s=eW(r)/1e6,n=Array.from(new Set(t.flatMap(e=>{var t;return(null==(t=e.steps)?void 0:t.map(e=>e.step_name))||[]}))).filter(Boolean);l(e=>{let r={...e.perStep};n.forEach(e=>{let s=[];t.forEach(t=>{var a;null==(a=t.steps)||a.forEach(t=>{t.step_name===e&&Array.isArray(t.step_response_time)&&s.push(...t.step_response_time)})});let l=eW(s)/1e6;r[e]||(r[e]=[]),r[e]=[...r[e],{timestamp:a,value:l}]});let l=Array.from(new Set(t.map(e=>e.vu_id.toString()))),o={...e.perVU};return l.forEach(e=>{let r=[];t.forEach(t=>{if(t.vu_id.toString()===e){var a;null==(a=t.steps)||a.forEach(e=>{Array.isArray(e.step_response_time)&&r.push(...e.step_response_time)})}});let s=eW(r)/1e6;o[e]||(o[e]=[]),o[e]=[...o[e],{timestamp:a,value:s}]}),{overall:[...e.overall,{timestamp:a,avg_latency:s}],perStep:r,perVU:o}})},[t]);let p=s.useMemo(()=>{if("overall"===n)return a.overall.map(e=>({timestamp:e.timestamp,avg_latency:e.avg_latency}));if("perStep"===n){let e=Object.keys(a.perStep);return Array.from(new Set(e.flatMap(e=>(a.perStep[e]||[]).map(e=>e.timestamp)))).sort((e,t)=>e-t).map(t=>{let r={timestamp:t};return e.forEach(e=>{let s=(a.perStep[e]||[]).find(e=>e.timestamp===t);s&&(r[e]=s.value)}),r})}if("perVU"===n){let e=Object.keys(a.perVU);return Array.from(new Set(e.flatMap(e=>(a.perVU[e]||[]).map(e=>e.timestamp)))).sort((e,t)=>e-t).map(t=>{let r={timestamp:t};return e.forEach(e=>{let s=(a.perVU[e]||[]).find(e=>e.timestamp===t);s&&(r[e]=s.value)}),r})}return[]},[a,n]),h=s.useMemo(()=>{if("overall"===n)return{avg_latency:{label:"Avg Latency (ms)",color:"var(--chart-1)"}};if("perStep"===n){let e=Object.keys(a.perStep),t=["var(--chart-1)","var(--chart-2)","var(--chart-3)","var(--chart-4)","var(--chart-5)"];return Object.fromEntries(e.map((e,a)=>[e,{label:e,color:t[a%t.length]}]))}if("perVU"===n){let e=Object.keys(a.perVU),t=["var(--chart-1)","var(--chart-2)","var(--chart-3)","var(--chart-4)","var(--chart-5)"];return Object.fromEntries(e.map((e,a)=>[e,{label:"VU ".concat(e),color:t[a%t.length]}]))}return{}},[n,a]),m=s.useMemo(()=>"perStep"===n?Object.entries(a.perStep).map(e=>{let[t,a]=e;return{key:t,label:t,data:a.map(e=>({timestamp:e.timestamp,value:e.value}))}}):"perVU"===n?Object.entries(a.perVU).map(e=>{let[t,a]=e;return{key:t,label:"VU ".concat(t),data:a.map(e=>({timestamp:e.timestamp,value:e.value}))}}):[],[n,a]),g=i?m:m.slice(0,4);return t&&0!==t.length?(0,r.jsxs)(eA,{className:"@container/card",children:[(0,r.jsx)(eV,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(ez,{children:"Average Latency"}),(0,r.jsxs)(eI,{children:[(0,r.jsxs)("span",{className:"hidden @[540px]/card:block",children:["Latency by ","overall"===n?"All Steps":"perStep"===n?"Step":"VU"]}),(0,r.jsx)("span",{className:"@[540px]/card:hidden",children:"Latency"})]})]}),(0,r.jsxs)(eB,{type:"single",value:n,onValueChange:e=>e&&o(e),variant:"outline",className:"gap-2",children:[(0,r.jsx)(eJ,{value:"overall",className:"text-xs transition-all ".concat("overall"===n?"bg-blue-100 text-blue-900 border-blue-300 shadow-sm":"hover:bg-gray-50"),children:"Overall"}),(0,r.jsx)(eJ,{value:"perStep",className:"text-xs transition-all ".concat("perStep"===n?"bg-blue-100 text-blue-900 border-blue-300 shadow-sm":"hover:bg-gray-50"),children:"Per Step"}),(0,r.jsx)(eJ,{value:"perVU",className:"text-xs transition-all ".concat("perVU"===n?"bg-blue-100 text-blue-900 border-blue-300 shadow-sm":"hover:bg-gray-50"),children:"Per VU"})]})]})}),(0,r.jsx)(eE,{className:"px-2 pt-4 sm:px-6 sm:pt-6",children:(0,r.jsx)(eR,{config:h,className:"aspect-auto h-[250px] w-full",children:(0,r.jsxs)(eS.Q,{data:p,children:[(0,r.jsx)(ek.d,{vertical:!1}),(0,r.jsx)(eF,{cursor:!1,content:(0,r.jsx)(eT,{indicator:"line",hideLabel:!0})}),Object.keys(h).map(e=>(0,r.jsx)(eC.Gk,{dataKey:e,type:"natural",fill:h[e].color,fillOpacity:.3,stroke:h[e].color,strokeWidth:2,name:h[e].label||e},e))]})})}),("perStep"===n||"perVU"===n)&&m.length>0&&(0,r.jsxs)("div",{className:"px-4",children:[m.length>4&&(0,r.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,r.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Individual ","perStep"===n?"Step":"VU"," Charts",(0,r.jsxs)("span",{className:"text-gray-500 font-normal ml-1",children:["(",i?m.length:Math.min(4,m.length)," of ",m.length,")"]})]}),(0,r.jsx)(u,{variant:"outline",size:"sm",onClick:()=>c(!i),className:"text-xs",children:i?"Show Less (4 of ".concat(m.length,")"):"Show All ".concat("perStep"===n?"Steps":"VUs"," (").concat(m.length,")")})]}),m.length<=4&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Individual ","perStep"===n?"Step":"VU"," Charts",(0,r.jsxs)("span",{className:"text-gray-500 font-normal ml-1",children:["(",m.length,")"]})]})}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:g.map((e,t)=>{let{key:a,label:s,data:l}=e,n=["var(--chart-1)","var(--chart-2)","var(--chart-3)","var(--chart-4)","var(--chart-5)"],o=n[t%n.length];return(0,r.jsxs)(eA,{className:"h-[180px] overflow-hidden",children:[(0,r.jsx)(eV,{children:(0,r.jsx)(ez,{className:"font-medium truncate leading-tight -m-2",title:s,children:s})}),(0,r.jsx)(eE,{className:"px-3",children:(0,r.jsx)("div",{className:"h-[130px] w-full",children:(0,r.jsx)(eR,{config:{value:{label:s,color:o}},className:"h-full w-full",children:(0,r.jsxs)(eS.Q,{data:l,margin:{top:20,right:2,left:2,bottom:20},children:[(0,r.jsx)(eF,{cursor:!1,content:(0,r.jsx)(eT,{indicator:"dot"})}),(0,r.jsx)(eC.Gk,{type:"natural",dataKey:"value",fill:o,fillOpacity:.4,stroke:o,strokeWidth:1.5,name:h[a].label||a})]})})})})]},a)})}),m.length>4&&(0,r.jsx)("div",{className:"mt-4 flex justify-center",children:(0,r.jsx)(u,{variant:"outline",size:"sm",onClick:()=>c(!i),className:"text-xs",children:i?"Show Less (4 of ".concat(m.length,")"):"Show All ".concat("perStep"===n?"Steps":"VUs"," (").concat(m.length,")")})})]})]}):(0,r.jsxs)(eA,{className:"w-full",children:[(0,r.jsxs)(eV,{children:[(0,r.jsx)(ez,{children:"Average Latency"}),(0,r.jsx)(eI,{children:"No data available"})]}),(0,r.jsx)(eE,{className:"h-[250px] flex items-center justify-center text-gray-500",children:"Waiting for load test data..."})]})}function eQ(){let{selectedDashboard:e,setSelectedDashboard:t}=function(){let e=(0,s.useContext)(P);if(void 0===e)throw Error("useDashboard must be used within a DashboardProvider");return e}(),[a,l]=(0,s.useState)({}),[n,o]=(0,s.useState)({}),[i,c]=(0,s.useState)({}),d=(null==e?void 0:e.id)||"",u=a[d]||[],p=n[d]||{overall:[],perStep:{},perVU:{}},h=(0,s.useRef)(a),g=(0,s.useRef)(n),x=(0,s.useRef)(i);(0,s.useEffect)(()=>{h.current=a},[a]),(0,s.useEffect)(()=>{g.current=n},[n]),(0,s.useEffect)(()=>{x.current=i},[i]),(0,s.useEffect)(()=>{try{let e=localStorage.getItem("dashboard-storage");if(e){let t=JSON.parse(e);l(t.dashboardData||{}),o(t.chartHistories||{}),c(t.dashboardStopTimes||{})}}catch(e){console.error("Failed to load from localStorage:",e)}},[]),(0,s.useEffect)(()=>{try{localStorage.setItem("dashboard-storage",JSON.stringify({dashboardData:a,chartHistories:n,dashboardStopTimes:i}))}catch(e){console.error("Failed to save to localStorage:",e)}},[a,n,i]);let f=async e=>{if(!e)return[];try{let t=await fetch(e,{cache:"no-store"});if(!t.ok)throw Error("Failed to fetch");let a=await t.json();if(console.log("Raw API data for ".concat(e,":"),a),!Array.isArray(a))return console.warn("API returned non-array data:",typeof a),[];let r=[],s=[];a.forEach((e,t)=>{if(!e||"number"!=typeof e.vu_id)return void s.push({index:t,item:e,reason:"Missing or invalid vu_id"});let a=_.safeParse(e);a.success?(r.push(a.data),console.log("Valid VU ".concat(a.data.vu_id," at index ").concat(t))):s.push({index:t,item:{vu_id:e.vu_id},reason:"Schema validation failed",errors:a.error.issues})}),console.log("Validation summary for ".concat(e,":")),console.log("- Raw items: ".concat(a.length)),console.log("- Valid VUs: ".concat(r.length)),console.log("- Invalid items: ".concat(s.length)),s.length>0&&console.log("Invalid data details:",s);let l=r.map(e=>e.vu_id).sort((e,t)=>e-t);return console.log("Valid VU IDs: [".concat(l.join(", "),"]")),r}catch(e){return console.error("Failed to fetch VU data:",e),[]}};(0,s.useEffect)(()=>{let t;if(!(null==e?void 0:e.url))return;if(i[d]&&"0s"!==i[d])return void console.log("Dashboard ".concat(d," is already stopped. Not polling."));let a=!0,r=0,s=async()=>{let s=x.current[d];if(s&&"0s"!==s){console.log("Dashboard ".concat(d," was stopped during polling.")),clearInterval(t);return}try{let t=await f(e.url);a&&(Array.isArray(t)&&t.length>0?(l(e=>({...e,[d]:t})),r=0):(r++,console.warn("No valid VU data received. Fail count: ".concat(r,"/").concat(3))))}catch(e){console.error("Error fetching VU data:",e),r++}if(r>=3&&t){if(clearInterval(t),!x.current[d]){let t="0s";if(null==e?void 0:e.created_at){let a=new Date(e.created_at).getTime(),r=Math.max(0,Math.floor((Date.now()-a)/1e3)),s=Math.floor(r/3600),l=Math.floor(r%3600/60),n=r%60;t=s>0?"".concat(s,"h ").concat(l,"m ").concat(n,"s"):l>0?"".concat(l,"m ").concat(n,"s"):"".concat(n,"s")}c(e=>({...e,[d]:t})),console.log("Dashboard ".concat(d," stopped after ").concat(3," failures. Final time: ").concat(t))}console.warn("Stopped polling for dashboard ".concat(d," due to repeated fetch failures."))}};return console.log("Starting data polling for dashboard: ".concat(d)),s(),t=setInterval(s,1e3),()=>{a=!1,t&&(clearInterval(t),console.log("Stopped polling for dashboard: ".concat(d)))}},[e,d]);let j=u.length;return(0,r.jsxs)(m,{children:[(0,r.jsx)(U,{selectedDashboard:e,onSelectDashboard:t,onDashboardDeleted:a=>{l(e=>{let t={...e};return delete t[a],t}),o(e=>{let t={...e};return delete t[a],t}),c(e=>{let t={...e};return delete t[a],t}),(null==e?void 0:e.id)===a&&t(null),console.log("Removed dashboard ".concat(a," from component state"))}}),(0,r.jsxs)(b,{children:[(0,r.jsxs)("header",{className:"flex h-12 items-center gap-2 border-b px-4",children:[(0,r.jsx)(v,{}),(0,r.jsx)("h1",{className:"text-lg font-semibold",children:e?e.title:"Select a Dashboard"}),e&&(0,r.jsxs)("span",{className:"text-xs text-gray-500 ml-auto",children:["VUs: ",j," | Status:"," ",i[d]?"Completed":"Running"]})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"@container/main flex flex-col gap-4 md:gap-6",children:[(0,r.jsx)(D,{lttoken:null!=e?e:void 0,stopped:!!(i[d]&&"0s"!==i[d]),stopTime:i[d],currentVUCount:j}),(0,r.jsx)(eq,{vuData:u,chartHistory:p,setChartHistory:e=>{o(t=>({...t,[d]:e(t[d]||{overall:[],perStep:{},perVU:{}})}))}}),(0,r.jsx)(ew,{data:u})]})})]})]})}function eX(){return(0,r.jsx)(O,{children:(0,r.jsx)(eQ,{})})}}},e=>{e.O(0,[931,441,964,358],()=>e(e.s=2769)),_N_E=e.O()}]);